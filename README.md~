malware_inspector
=================

The python script takes advantage of VirusTotal API and Team Cymru services to find any malicious process or the file/directory on the system and sends an e-mail alert if any malware is found.
The main features are:
* Monitors all the running processes for malicious activities using Virustotal(https://www.virustotal.com/en/documentation/public-api/) and TeamCymru(http://www.team-cymru.org/Services/MHR/)
* Sends an e-mail when any malicious process/file/directory is detected.

A big thanks to both Virustotal and Team Cymru teams for providing such wonderful services that allows checking of malicious contents.

For convenience,the scripts are divided in two parts: Process monitor and file/directory monitor

* Process monitor - Checks all the running processes against Virustotal and Team Cymru's malware hashes
* File/directory monitor - Checks the file or directory against Virustotal and Team Cymru's malware hashes

Installation
=============
The code has been tested on CentOS distribution but should work on other platforms like Windows without any issue.

Running
=======

* Add virustotal key in the configuration file - etc/malware_inspector.conf
If you do not have the key, you will need to register in Virustotal Community group using https://www.virustotal.com/en/#signup
* If you are using proxy, set appropriate proxy settings in the configuration files -
    * process monitor script - set up proxy in etc/malware_inspector.conf file.
    * file/directory script - set up proxy in virustotal.conf or teamcymru-malware-check.conf file.
* Set appropriate e-mail server options if you wish to receive an e-mail when any suspicious process is detected.
* Make sure that the paths of all the files in 'malware_inspector.conf' are valid.

For running the script, use the following command:
$python malware_inspector.py -c etc/malware_inspector.conf

If any suspicious processes are detected, you will get an e-mail. Also, the results of the process scan are available in malware_results.txt file.

To do
========
A graphical GUI for both Linux and Windows